!function(){!async function(){new FormData;try{const e="http://localhost:3000/api/civilizacion",t=await fetch(e,{method:"Get"}),o=await t.json();console.log(o)}catch(e){console.log(e)}}();let e=[],t=[];function o(t=!1,o={}){modal=document.createElement("div"),modal.classList.add("modal"),modal.innerHTML=`\n        <form class="formulario nueva tarea" method="POST">\n            <legend>${t?"Editar Tarea":"Añade una nueva tarea"}</legend>\n            <div class="campo">\n            <label>Tarea</label>\n            <input required type="text" id="tarea" name="tarea"\n            placeholder="${o.nombre?"Editar la Tarea":"Añadir una nueva tarea al Proyecto"}" value="${o.nombre?o.nombre.trim():""}" />\n            </div>\n            <div class="opciones">\n                <input type="submit" class="submit-nueva-tarea" value="${t?"Editar Tarea":"Añadir Tarea"}" />\n                <button type="button" class="cerrar-modal">Cancelar</button>\n            </div>\n        </form>\n        `,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar"),document.querySelector("#tarea").focus()},0),modal.addEventListener("click",(function(r){if(r.preventDefault(),r.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{modal.remove()},500)}if(r.target.classList.contains("submit-nueva-tarea")){const r=document.querySelector("#tarea").value.trim();""===r?a("Debes añadir un nombre para la tarea","error",document.querySelector(".formulario legend")):!0===t?(o.nombre=r,c(o)):async function(t){const o=obtenerProyecto(),r=new FormData;r.append("nombre",t),r.append("proyectoid",o);try{const o="https://morning-tor-49638.herokuapp.com/api/tarea",c=await fetch(o,{method:"POST",body:r}),i=await c.json();if(a(i.mensaje,i.tipo,document.querySelector(".formulario legend")),"correcto"===i.tipo){const o={id:String(i.id),nombre:t,estado:"0",proyectoid:i.proyectoid};e=[...e,o],n()}}catch(e){console.log(e)}}(r)}})),document.querySelector(".dashboard").appendChild(modal)}function a(e,t,o){const a=document.querySelector(".alerta");a&&a.remove();const n=document.createElement("div");n.classList.add("alerta",t),n.textContent=e,o.parentElement.insertBefore(n,o.nextElementSibling),setTimeout(()=>{n.remove()},2e3)}function n(){!function(){const e=document.querySelector("#listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.estado),o=document.querySelector("#pendientes");0===t.length?o.disabled=!0:o.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.estado),o=document.querySelector("#completadas");0===t.length?o.disabled=!0:o.disabled=!1}();const a=t.length?t:e;if(0===a.length){const e=document.querySelector("#listado-tareas"),t=document.createElement("li");t.textContent="No Hay Tareas",t.classList.add("no-tareas"),e.appendChild(t)}else{const t={0:"Pendiente",1:"Completa"};a.forEach(a=>{const r=document.createElement("li");r.dataset.tareaId=a.id,r.classList.add("tarea");const i=document.createElement("p");i.textContent=a.nombre,i.ondblclick=function(){o(!0,{...a})};const d=document.createElement("div");d.classList.add("opciones");const s=document.createElement("button");s.classList.add(""+t[a.estado].toLowerCase()),s.classList.add("estado-tarea"),s.textContent=t[a.estado],s.dataset.estadoTarea=a.estado,s.onclick=function(){!function(e){const t="1"===e.estado?"0":"1";e.estado=t,c(e)}({...a})};const l=document.createElement("button");l.classList.add("eliminar-tarea"),l.textContent="Eliminar",l.dataset.idTarea=a.id,l.onclick=function(){!function(t){Swal.fire({title:"¿Quiere Eliminar la Tarea?",text:"No podras revertir esta accion!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Eliminalo!",cancelButtonText:"No, Conservalo!"}).then(o=>{o.isConfirmed&&async function(t){const{estado:o,id:a,nombre:r,proyectoid:c}=t,i=new FormData;i.append("estado",o),i.append("id",a),i.append("nombre",r),i.append("proyectoid",c),i.append("url",obtenerProyecto());try{const o="https://morning-tor-49638.herokuapp.com/api/tarea/eliminar",a=await fetch(o,{method:"POST",body:i}),r=await a.json();console.log(r),"correcto"===r.tipo?(Swal.fire("Eliminado!",r.mensaje,"success"),e=e.filter(e=>e.id!==t.id),n()):Swal.fire("Eliminado!",r.mensaje,"error")}catch(e){console.log(e)}}(t)})}({...a})};const m=document.querySelector("#listado-tareas");d.appendChild(s),d.appendChild(l),r.appendChild(i),r.appendChild(d),m.appendChild(r)})}}function r(o){const a=o.target.value;t=""!==a?e.filter(e=>e.estado===a):[],n()}async function c(t){const{estado:o,id:a,nombre:r,proyectoid:c}=t,i=new FormData;i.append("estado",o),i.append("id",a),i.append("nombre",r.trim()),i.append("proyectoid",c),i.append("url",obtenerProyecto());try{const t="https://morning-tor-49638.herokuapp.com/api/tarea/actualizar",o=await fetch(t,{method:"POST",body:i}),r=await o.json();if("correcto"===r.tipo){Swal.fire({icon:"success",title:r.mensaje,text:r.tipo});const t=document.querySelector(".modal");t&&t.remove(),e=e.map(e=>(e.id===a&&e.id===r.id&&(e.estado=r.estado,e.nombre=r.nombre),e)),n()}}catch(e){console.log(e)}}document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",r)})}();